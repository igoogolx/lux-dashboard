"use strict";(self.webpackChunklux_dashboard=self.webpackChunklux_dashboard||[]).push([[858],{6858:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ze});var n=a(7294),l=a(634),r=a(6575),c=a(5998),s=a(7860),i=a(2580),o=a(2230),d=a(2327),m=a(8142),u=a(5071),p=a(7926),E=a(3232),b=a(2132),C=a(3669),y=a(490),S=a(1171);function O(e){const{onConfirm:t,onClose:a}=e,{t:r}=(0,d.$)();return n.createElement(l.sm,{title:r(m.$.WARNING),content:r(m.$.DELETE_ALL_PROXIES_TIPS),hideCancelText:!0,onConfirm:t,onCancel:a})}var _=a(5093),g=a(1275),h=a(1092),N=a(7390);const v={item:"Udu6yxXNAw2wiYHcCkxp",content:"iLbXplUrNoA6yC3Ij5cA"},$={directedInterfaceName:m.$.COMMON_DEFAULT_INTERFACE_NAME,directedInterfaceV4Addr:m.$.DEFAULT_INTERFACE_V4_ADDR,tunInterfaceName:m.$.COMMON_TUN_INTERFACE_NAME,localDns:m.$.SETTING_PRIMARY_DNS,remoteDns:m.$.SETTING_SECONDARY_DNS,hubAddress:m.$.HUB_ADDRESS};function R(e){const{close:t}=e,{t:a}=(0,d.$)(),[c,s]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(0,r.Ch)().then((e=>{const t=(0,_.PR)();s({...e,hubAddress:(0,_.cu)(t)})}))}),[]),c?n.createElement(l.u_,{close:t},Object.keys(c).map((e=>{const t=Array.isArray(c[e])?c[e].join(","):c[e];return n.createElement("div",{className:v.item,key:e},n.createElement(h.T,null,`${a($[e])}:`),n.createElement("div",{className:v.content},"hubAddress"===e?n.createElement(b.z,{onClick:()=>{(0,g.LQ)(`http://${t}`)},appearance:"transparent"},n.createElement(N.r,{as:"button"},t)):t))}))):n.createElement(n.Fragment,null)}var f,w=a(6914);function k(){const{t:e}=(0,d.$)(),t=(0,c.I0)(),[a,l]=(0,n.useState)(!1),[s,o]=(0,n.useState)(!1),_=(0,c.v9)((e=>e.manager.isStared)),g=(0,u.jb)(),h=(0,c.v9)(i.hl.selectAll),[N,v]=(0,n.useState)(!1),$=()=>{o(!1)},k=(0,n.useMemo)((()=>[{id:f.TestDelay,content:e(m.$.CONNECTIVITY_TEST),disabled:N},{id:f.RuntimeDetail,content:e(m.$.COMMON_RUNTIME_DETAIL),disabled:!_},{id:f.DeleteAllProxies,content:e(m.$.DELETE_ALL_PROXIES),disabled:_,isDanger:!0}]),[_,e,N]);return n.createElement(n.Fragment,null,s&&n.createElement(O,{onClose:$,onConfirm:async()=>{await(0,r.pn)(),t(i.LF.actions.deleteAll()),t(i.mw.actions.setProxy({id:""})),$()}}),a&&n.createElement(R,{close:()=>{l(!1)}}),n.createElement(p.v,null,n.createElement(E.b,{disableButtonEnhancement:!0},n.createElement(b.z,{icon:n.createElement(w.LfN,null)})),n.createElement(C.Y,null,n.createElement(y.q,null,k.map((e=>n.createElement(S.s,{key:e.id,onClick:()=>{(e=>{switch(e){case f.TestDelay:return void(async()=>{v(!0);try{h.forEach((e=>{t(i.LF.actions.updateOne({proxy:{id:e.id,delay:void 0}}))}));const e=function(e,t=4){const a=[];for(let n=0;n<e.length;n+=t)a.push(e.slice(n,n+t));return a}(h);for(let t=0;t<e.length;t+=1)await Promise.all(e[t].map((e=>g(e.id))))}finally{v(!1)}})();case f.RuntimeDetail:return void l(!0);case f.DeleteAllProxies:return void o(!0);default:throw new Error(`invalid ${e}`)}})(e.id)},disabled:e.disabled},e.content)))))))}!function(e){e.RuntimeDetail="0",e.TestDelay="1",e.DeleteAllProxies="2"}(f||(f={}));var A=a(682),F=a(8861),T=a(3738),I=a(6310);const M=65535,L={buttonContainer:"SaBxbWlCJasQyDQpT6Sw",button:"k6YMG5GNLGeeju5qUmNQ"},x={type:r.c0.Http,server:"",id:"",name:"",port:1080,password:"",username:""},D=I.Ry().shape({name:I.Z_(),server:I.Z_().required("Required"),port:I.Rx().min(0).max(M).required("Required"),username:I.Z_(),password:I.Z_()});function P(e){const{t}=(0,d.$)(),{close:a,initialValue:s,isSelected:o}=e,u=(0,c.I0)(),p=(0,c.v9)((e=>e.manager.isStared));return n.createElement(l.l0,{onSubmit:async e=>{if(s)await(0,r.Jc)({id:e.id,proxy:e}),u(i.LF.actions.updateOne({proxy:e}));else{const{id:t}=await(0,r.qg)({proxy:e});u(i.LF.actions.addOne({proxy:{...e,id:t}}))}a()},initialValues:s||x,validationSchema:D},(({dirty:e,submitForm:r})=>n.createElement(n.Fragment,null,n.createElement(l.gN,{name:"name",label:t(m.$.FORM_NAME)}),n.createElement(l.gN,{name:"server",label:t(m.$.FORM_SERVER)}),n.createElement(l.gN,{name:"port",label:t(m.$.FORM_PORT),type:"number"}),n.createElement(l.gN,{name:"username",label:`${t(m.$.FORM_PASSWORD)}(${t(m.$.FORM_OPTIONAL)})`}),n.createElement(l.gN,{name:"password",label:`${t(m.$.FORM_USERNAME)}(${t(m.$.FORM_OPTIONAL)})`}),n.createElement("div",{className:L.buttonContainer},n.createElement(b.z,{onClick:a,className:L.button},t(m.$.FORM_CANCEL)),n.createElement(b.z,{className:L.button,disabled:!e||o&&p,onClick:r,appearance:"primary"},t(m.$.FORM_SAVE))))))}var V=a(2761),q=a(4485),U=a(3257);const B=["aes-128-gcm","aes-192-gcm","aes-256-gcm","rc4-md5","aes-128-cfb","aes-192-cfb","aes-256-cfb","aes-128-ctr","aes-192-ctr","aes-256-ctr","bf-cfb","camellia-128-cfb","camellia-192-cfbw","camellia-256-cfb","chacha20-ietf-poly1305","xchacha20-ietf-poly1305","salsa20","chacha20","chacha20-ietf"],H=["obfs","v2ray-plugin"],Z="none";var j;!function(e){e[e.First=0]="First",e[e.Second=1]="Second"}(j||(j={}));const Q={buttonContainer:"EBoNextEA3Qissmj96dg",button:"lFdYuErcPPvOrcvkQ_qr"},Y={type:r.c0.Socks5,server:"",id:"",name:"",port:1080,password:"",username:""},z=I.Ry().shape({name:I.Z_(),server:I.Z_().required("Required"),port:I.Rx().min(0).max(M).required("Required"),username:I.Z_(),password:I.Z_()});function W(e){const{t}=(0,d.$)(),{close:a,initialValue:s,isSelected:o}=e,u=(0,c.I0)(),p=(0,c.v9)((e=>e.manager.isStared));return n.createElement(l.l0,{onSubmit:async e=>{if(s)await(0,r.Jc)({id:e.id,proxy:e}),u(i.LF.actions.updateOne({proxy:e}));else{const{id:t}=await(0,r.qg)({proxy:e});u(i.LF.actions.addOne({proxy:{...e,id:t}}))}a()},initialValues:s||Y,validationSchema:z},(({dirty:e,submitForm:r})=>n.createElement(n.Fragment,null,n.createElement(l.gN,{name:"name",label:t(m.$.FORM_NAME)}),n.createElement(l.gN,{name:"server",label:t(m.$.FORM_SERVER)}),n.createElement(l.gN,{name:"port",label:t(m.$.FORM_PORT),type:"number"}),n.createElement(l.gN,{name:"username",label:`${t(m.$.FORM_PASSWORD)}(${t(m.$.FORM_OPTIONAL)})`}),n.createElement(l.gN,{name:"password",label:`${t(m.$.FORM_USERNAME)}(${t(m.$.FORM_OPTIONAL)})`}),n.createElement("div",{className:Q.buttonContainer},n.createElement(b.z,{onClick:a,className:Q.button},t(m.$.FORM_CANCEL)),n.createElement(b.z,{className:Q.button,disabled:!e||o&&p,onClick:r,appearance:"primary"},t(m.$.FORM_SAVE))))))}const K=I.Ry().shape({name:I.Z_(),server:I.Z_().required("Required"),port:I.Rx().min(0).max(M).required("Required"),password:I.Z_().required("Required"),method:I.Z_()}),X=I.Ry().shape({host:I.Z_().required("Required"),mode:I.Z_().matches(new RegExp(`(${r.V_.Tls}|${r.V_.Http})`)).required("Required")}),J=I.Ry().shape({host:I.Z_().required("Required"),port:I.Rx().required("Required"),path:I.Z_().required("Required"),mode:I.Z_().matches(/websocket/).required("Required")}),G={buttonContainer:"RwAz2b3aKPTgn0Y7C59t",button:"fr7hC0nVXyn9oqs_8VxL"};function ee(e){const{t}=(0,d.$)(),{close:a,initialValue:c,onChange:s}=e,i=(0,n.useRef)([{id:r.V_.Http,content:"Http"},{id:r.V_.Tls,content:"Tls"}]);return n.createElement(l.l0,{onSubmit:async e=>{s(e),a()},initialValues:c,validationSchema:X},(({dirty:e,submitForm:r})=>n.createElement(n.Fragment,null,n.createElement(l.gN,{name:"host",label:t(m.$.HOST)}),n.createElement(l.el,{name:"mode",label:t(m.$.MODE),items:i.current}),n.createElement("div",{className:G.buttonContainer},n.createElement(b.z,{onClick:a,className:G.button},t(m.$.FORM_CANCEL)),n.createElement(b.z,{className:G.button,disabled:!e,onClick:r,appearance:"primary"},t(m.$.FORM_SAVE))))))}const te={buttonContainer:"K3tQudjfbN50TBFfFBAn",button:"lvt3w2g1YLpyMZHjLzGJ"};function ae(e){const{t}=(0,d.$)(),{close:a,initialValue:r,onChange:c}=e;return n.createElement(l.l0,{onSubmit:async e=>{c(e),a()},initialValues:r,validationSchema:J},(({dirty:e,submitForm:r})=>n.createElement(n.Fragment,null,n.createElement(l.gN,{name:"mode",label:t(m.$.MODE)}),n.createElement(l.gN,{name:"host",label:t(m.$.HOST)}),n.createElement(l.gN,{name:"port",label:t(m.$.FORM_PORT)}),n.createElement(l.gN,{name:"path",label:t(m.$.PATH)}),n.createElement(l.QB,{name:"tls",label:t(m.$.TLS)}),n.createElement(l.QB,{name:"skipCertVerify",label:t(m.$.SKIP_CERT_VERIFY)}),n.createElement("div",{className:te.buttonContainer},n.createElement(b.z,{onClick:a,className:te.button},t(m.$.FORM_CANCEL)),n.createElement(b.z,{className:te.button,disabled:!e,onClick:r,appearance:"primary"},t(m.$.FORM_SAVE))))))}const ne={buttonContainer:"v5sytDviXZuncu3OD2_l",button:"Psr6pVXCaNzrV4tD4ptm"};function le(e){const{t}=(0,d.$)(),{close:a,onChange:l}=e;return n.createElement("div",{className:ne.buttonContainer},n.createElement(b.z,{onClick:a,className:ne.button},t(m.$.FORM_CANCEL)),n.createElement(b.z,{className:ne.button,onClick:async()=>{l(),a()},appearance:"primary"},t(m.$.FORM_SAVE)))}const re={mode:"websocket",host:"",port:"",path:"",tls:!1,skipCertVerify:!1},ce={host:"",mode:r.V_.Http};function se(e){const{type:t=r.AQ.Obfs,close:a,initialValue:c,onSave:s}=e;let i=null;const o={[r.AQ.Obfs]:"Obfs",[r.AQ.V2ray]:"v2ray-plugin",[Z]:"None"},[u,p]=(0,n.useState)(t),{t:E}=(0,d.$)();switch(u){case r.AQ.Obfs:i=n.createElement(ee,{close:a,initialValue:c["plugin-opts"]||ce,onChange:e=>{s({plugin:u,"plugin-opts":e})}});break;case r.AQ.V2ray:i=n.createElement(ae,{close:a,initialValue:c["plugin-opts"]||re,onChange:e=>{s({plugin:u,"plugin-opts":e})}});break;case Z:i=n.createElement(le,{close:a,onChange:()=>{s({plugin:void 0,"plugin-opts":void 0})}});break;default:throw new Error(`invalid ${t}`)}return n.createElement(l.u_,{close:a,hideCloseButton:!0,hideOkButton:!0},n.createElement("div",{className:"JLE807QSbIA4RATOID4n"},n.createElement(V.x,null,E(m.$.TYPE)),n.createElement(q.L,{defaultValue:o[u],onOptionSelect:(e,t)=>{p(t.optionValue)}},Object.keys(o).map((e=>n.createElement(U.W,{key:e,text:o[e],value:e},o[e]))))),i)}const ie="Y_sTMjn3xzjL5Yi0lfbw",oe={type:r.c0.Shadowsocks,id:"",name:"",server:"",password:"",port:1080,cipher:B[0]},de=n.memo((e=>{const{close:t,initialValue:a,isSelected:s=!1,setPageStep:o}=e,{t:u}=(0,d.$)(),p=(0,c.I0)(),E=(0,n.useRef)(B.map((e=>({content:e,id:e})))),C=(0,n.useRef)([...H,Z].map((e=>({content:e,id:e})))),y=(0,c.v9)((e=>e.manager.isStared)),[S,O]=(0,n.useState)(!1),_=a||oe,g={plugin:_.plugin,"plugin-opts":_["plugin-opts"]},[h,N]=(0,n.useState)(g);return S?n.createElement(se,{type:h.plugin,initialValue:h,onSave:e=>{N(e)},close:()=>{O(!1),o&&o(j.First)}}):n.createElement(l.l0,{validationSchema:K,initialValues:_,onSubmit:async e=>{if(a)await(0,r.Jc)({id:e.id,proxy:{...e}}),p(i.LF.actions.updateOne({proxy:e}));else{const{id:t}=await(0,r.qg)({proxy:{...e}});p(i.LF.actions.addOne({proxy:{...e,id:t}}))}t()}},(({dirty:e,submitForm:a,isValid:r,submitCount:c})=>n.createElement("div",{className:"qc0j8qlJrLZCU2O9RosZ"},n.createElement(l.gN,{name:"name",label:u(m.$.FORM_NAME)}),n.createElement(l.gN,{name:"server",label:u(m.$.FORM_SERVER)}),n.createElement(l.el,{name:"cipher",items:E.current,label:u(m.$.FORM_ENCRYPTION)}),n.createElement(l.gN,{name:"port",label:u(m.$.FORM_PORT),type:"number"}),n.createElement(l.BL,{name:"password",label:u(m.$.FORM_PASSWORD)}),n.createElement(l.el,{clearable:!0,value:h.plugin,name:"plugin",items:C.current,label:`${u(m.$.FORM_PLUGIN)}(${u(m.$.FORM_OPTIONAL)})`,editable:!0,onEditClick:()=>{O(!0),o&&o(j.Second)}}),n.createElement("div",{className:"_Q_MjOo3GU3F8qKQ9unB"},n.createElement(b.z,{onClick:t,className:ie},u(m.$.FORM_CANCEL)),n.createElement(b.z,{className:ie,disabled:!e||!r&&c>0||s&&y,onClick:a,appearance:"primary"},u(m.$.FORM_SAVE))))))})),me={type:"SUSY32rRm5rL0xod8aRY"};function ue(e){const{type:t,close:a,initialValue:c,isSelected:s=!1}=e;let i=null;const o={[r.c0.Shadowsocks]:"Shadowsocks",[r.c0.Http]:"Http",[r.c0.Socks5]:"Socks5"},[u,p]=(0,n.useState)(t),[E,b]=(0,n.useState)(j.First),{t:C}=(0,d.$)();switch(u){case r.c0.Shadowsocks:i=n.createElement(de,{close:a,initialValue:c,isSelected:s,setPageStep:b});break;case r.c0.Socks5:i=n.createElement(W,{close:a,initialValue:c,isSelected:s});break;case r.c0.Http:i=n.createElement(P,{close:a,initialValue:c,isSelected:s});break;default:throw new Error(`invalid ${t}`)}return n.createElement(l.u_,{close:a,hideCloseButton:!0,hideOkButton:!0},E===j.First&&n.createElement("div",{className:me.type},n.createElement(V.x,null,C(m.$.TYPE)),n.createElement(q.L,{disabled:!!c,defaultValue:o[u],onOptionSelect:(e,t)=>{p(t.optionValue)}},Object.keys(o).map((e=>n.createElement(U.W,{key:e,text:o[e],value:e},o[e]))))),i)}var pe=a(6647);const Ee=e=>e.split(/[\n\r ]/).map((e=>(e=>{const t={type:r.c0.Shadowsocks,id:"",name:e.tag.data,server:e.host.data,port:e.port.data,cipher:e.method.data,password:e.password.data,udp:!0},a=e.extra.plugin;if(a){const e=a.indexOf(";");t.plugin=a.substring(0,e),t.plugin?.includes("obfs")&&(t.plugin=r.AQ.Obfs),t["plugin-opts"]=(e=>{const t={};return e.split(";").forEach((e=>{const a=e.split("=");if(2===a.length){const[e,n]=a;"obfs"===e?t.mode=n:"obfs-host"===e?t.host=n:t[e]=n}})),t})(a.substring(e+1))}return t})(pe.SHADOWSOCKS_URI.parse(e)))),be=e=>{let t=`${e.plugin}`;return e["plugin-opts"]&&(t=`${t};${(e=>{let t="";return Object.keys(e).forEach((a=>{let n="";const l=e[a];"string"==typeof l?n=`${a}=${l}`:l&&(n=a),n&&(t=t?`${t};${n}`:n)})),t})(e["plugin-opts"])}`),pe.SIP002_URI.stringify((0,pe.makeConfig)({host:e.server,port:e.port,method:e.cipher,password:e.password,tag:e.name,plugin:t}))};var Ce=a(7247),ye=a(1588);const Se=function(e){const{close:t}=e,{t:a}=(0,d.$)(),[s,o]=(0,n.useState)(""),[u,p]=(0,n.useState)(!1),E=(0,c.I0)();return(0,n.useEffect)((()=>{(0,r.JC)().then((e=>{o(e.url)}))}),[]),n.createElement(l.u_,{close:t,onOk:async()=>{try{p(!0),await(0,r.tE)({url:s});const e=await(0,r.VU)({url:s});E(i.LF.actions.addMany(e)),t()}finally{p(!1)}},disabledOk:u},n.createElement("div",{className:"jHD4NfXRB7_joiKIrapz"},n.createElement(ye.I,{value:s,onChange:e=>{o(e.target.value)},className:"jiZBXuixW_xp1_uozKBe",placeholder:a(m.$.CLASH_URL),autoFocus:!0})))};var Oe,_e=a(6152);function ge(e){const{className:t}=e,{t:a}=(0,d.$)(),[l,s]=(0,n.useState)(null),o=(0,c.I0)(),[u,O]=(0,n.useState)(!1),_=[{id:Oe.Shadowsocks,content:a(m.$.SHADOWSOCKS)},{id:Oe.Socks5,content:a(m.$.SOCKS5)},{id:Oe.Http,content:a(m.$.HTTP)},{id:Oe.Clipboard,content:a(m.$.CLIPBOARD_IMPORT)},{id:Oe.CLASH,content:a(m.$.CLASH_IMPORT)},{id:Oe.ClashUrl,content:a(m.$.CLASH_URL_IMPORT)}];return n.createElement("div",{className:t},u&&n.createElement(Se,{close:()=>{O(!1)}}),l&&n.createElement(ue,{close:()=>{s(null)},type:l}),n.createElement(p.v,null,n.createElement(E.b,{disableButtonEnhancement:!0},n.createElement(b.z,{icon:n.createElement(_e.r_L,null)})),n.createElement(C.Y,null,n.createElement(y.q,null,_.map((e=>n.createElement(S.s,{key:e.id,onClick:()=>{(async e=>{switch(e){case Oe.Shadowsocks:s(r.c0.Shadowsocks);break;case Oe.Socks5:s(r.c0.Socks5);break;case Oe.Http:s(r.c0.Http);break;case Oe.Clipboard:{const e=await navigator.clipboard.readText(),t=Ee(e);await Promise.all(t.map((async e=>{const t={...e,type:r.c0.Shadowsocks},a=await(0,r.qg)({proxy:t});o(i.LF.actions.addOne({proxy:{...t,id:a.id}}))})));break}case Oe.CLASH:{const e=await navigator.clipboard.readText(),t=(0,Ce.Qc)(e);await Promise.all(t.proxies.map((async e=>{const t=await(0,r.qg)({proxy:e});o(i.LF.actions.addOne({proxy:{...e,id:t.id}}))})));break}case Oe.ClashUrl:O(!0);break;default:throw new Error(`invalid ${e}`)}})(e.id)}},e.content)))))))}!function(e){e[e.Shadowsocks=0]="Shadowsocks",e[e.Socks5=1]="Socks5",e[e.Clipboard=2]="Clipboard",e[e.Http=3]="Http",e[e.CLASH=4]="CLASH",e[e.ClashUrl=5]="ClashUrl"}(Oe||(Oe={}));const he={wrapper:"Gc8PPCFelr5RdihkBQG9",rulesDropdown:"Pxv6kA6NLwKWYIchoqmN",addButton:"t4XhkwkD25jmnZ5Lpit7",testButton:"qYMwXJUCEJtzDcFpJWVQ"};function Ne(){const{t:e}=(0,d.$)(),t=(0,c.v9)((e=>e.manager.isStared)),a=(0,c.v9)((e=>e.manager.isLoading)),[u,b]=(0,n.useState)(!1),O=(0,c.v9)((e=>!!e.setting.outbound.autoMode.enabled||!(!e.selected.proxy||!e.proxies.ids.includes(e.selected.proxy)))),_=(0,c.I0)(),g=(0,c.v9)(i.k8.selectAll),h=(0,c.v9)((e=>e.selected.rule)),[N,v]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(0,r.$c)().then((e=>{_(i.LU.actions.received(e)),_(s.m.actions.setRule({id:e.selectedId}))}))}),[_]);const $=(0,n.useCallback)((async e=>{try{b(!0),await(0,r.kY)({id:e}),_(s.m.actions.setRule({id:e}))}finally{b(!1)}}),[_]),R=(0,n.useMemo)((()=>g.map((t=>({id:t.id,content:e(t.id)})))),[g,e]),f=a||!O||u;return n.createElement("div",{className:he.wrapper},n.createElement(k,null),n.createElement(ge,{className:he.addButton}),n.createElement(p.v,null,n.createElement(E.b,{disableButtonEnhancement:!0},n.createElement(A.j,{disabled:t||u},e(h))),n.createElement(C.Y,null,n.createElement(y.q,null,R.map((e=>n.createElement(S.s,{disabled:e.disabled,key:e.id,icon:e.icon,onClick:()=>{$(e.id)}},e.content)))))),n.createElement(F.u,{content:e(m.$.SWITCH_DISABLE_TIP),relationship:"description",visible:N&&f,onVisibleChange:(e,t)=>v(t.visible)},n.createElement(T.r,{checked:t,onChange:async()=>{try{_(o.m.actions.setIsLoading({isLoading:!0})),t?await(0,r.sT)():await(0,r.BL)(),_(o.m.actions.setIsStarted({isStarted:!t}))}catch(e){l.rB.error(e.message||"unknown error")}finally{_(o.m.actions.setIsLoading({isLoading:!1}))}},disabled:f})))}const ve={wrapper:"makDUtZ7nLl5YwLZ_81d",header:"rHoRQy73BKWNrkFngo76",content:"aAnpLd7JizxJyCv19aWV"};var $e=a(5201),Re=a(4656),fe=a(2592);const we={container:"dY96wPEsmrbJ5I9qiBbR"},ke="qr-code";function Ae(e){const{url:t,close:a}=e,{t:r}=(0,d.$)();return(0,n.useEffect)((()=>{fe.toCanvas(document.getElementById(ke),t).catch((e=>{l.rB.error(e.message||r(m.$.UNKNOWN_ERROR))}))}),[r,t]),n.createElement(l.u_,{close:a},n.createElement("div",{className:we.container},n.createElement("canvas",{id:ke})))}var Fe=a(842);const Te=()=>{const e=(0,c.I0)(),{t}=(0,d.$)();return(0,n.useCallback)((async a=>{e(Fe.b.actions.updateOne({data:{id:a,loading:!0}}));try{const n=await(0,r.Z9)({id:a});e(Fe.b.actions.updateOne({data:{id:a,result:n.result}})),n.result?l.rB.success(t(m.$.UDP_OK_NOTIFICATION)):l.rB.error(t(m.$.UDP_FAILED_NOTIFICATION))}catch(t){e(Fe.b.actions.updateOne({data:{id:a,result:!1}}))}finally{e(Fe.b.actions.updateOne({data:{id:a,loading:!1}}))}}),[e,t])};var Ie,Me=a(6475),Le=a(8870);function xe(e){const{t}=(0,d.$)(),{proxy:a}=e,{id:o}=a,[O,_]=(0,n.useState)(!1),[g,h]=(0,n.useState)(!1),N=(0,c.I0)(),v=(0,u.jb)(),$=Te(),R=(0,c.v9)((e=>e.manager.isStared)),f=(0,c.v9)((e=>e.manager.isLoading)),k=(0,c.v9)((e=>e.selected.proxy===o)),A=(0,n.useMemo)((()=>{let e=[{id:Ie.Test,content:t(m.$.CONNECTIVITY_TEST),icon:n.createElement(Me.DcD,null)},{id:Ie.TestUdp,content:t(m.$.COMMON_TEST_UDP),icon:n.createElement(Le.n4b,null)},{id:Ie.Delete,content:t(m.$.COMMON_DELETE),icon:n.createElement(Me.X10,null),disabled:(R||f)&&k,isDanger:!0,isDivider:!0}];return[r.c0.Shadowsocks,r.c0.Http,r.c0.Socks5].includes(a.type)?(e=[{id:Ie.Edit,content:t(m.$.COMMON_EDIT),icon:n.createElement(Me.l_e,null)},...e],a.type===r.c0.Shadowsocks&&(e=[{id:Ie.CopyUrl,content:t(m.$.COMMON_COPY_URL),icon:n.createElement(_e.FOW,null)},{id:Ie.QrCode,content:t(m.$.COMMON_QR_CODE),icon:n.createElement(Le.mFX,null)},...e]),e):e}),[k,R,f,a.type,t]);return n.createElement(n.Fragment,null,g&&n.createElement(Ae,{url:be(a),close:()=>{h(!1)}}),O&&n.createElement(ue,{close:()=>_(!1),initialValue:a,type:a.type,isSelected:k}),n.createElement(p.v,null,n.createElement(E.b,{disableButtonEnhancement:!0},n.createElement(b.z,{appearance:"transparent",icon:n.createElement(w.pSu,null),onClick:e=>{e.stopPropagation()}})),n.createElement(C.Y,null,n.createElement(y.q,null,A.map((e=>n.createElement(S.s,{disabled:e.disabled,key:e.id,icon:e.icon,onClick:n=>{n.stopPropagation(),(async e=>{switch(e){case Ie.Edit:return void _(!0);case Ie.Delete:return await(0,r.M0)({id:a.id}),N(i.LF.actions.deleteOne({id:o})),k&&N(s.m.actions.setProxy({id:""})),void l.rB.success(t(m.$.DELETED));case Ie.Test:return void await v(o);case Ie.TestUdp:return void await $(o);case Ie.CopyUrl:{const e=be(a);return await navigator.clipboard.writeText(e),void l.rB.success(t(m.$.COPIED))}case Ie.QrCode:return void h(!0);default:throw new Error(`invalid ${e}`)}})(e.id)}},e.content)))))))}!function(e){e.Edit="edit",e.Delete="delete",e.CopyUrl="copyUrl",e.Test="test",e.QrCode="qrCode",e.TestUdp="testUdp"}(Ie||(Ie={}));var De=a(4184),Pe=a.n(De);const Ve={icon:"iX0lj0Qnm_LeFVjIszAx",error:"B_lwM5S6on_QZjJtWFf7",warn:"CiO2Ztcm3IxAaKhLhrAA",success:"hFAcns3Z9iWsUoqjgUrg",loading:"Wig5XehzyXCQ0qjNTuPG",spin:"c9KBAYnOrZ6ojplykr_I"};var qe;function Ue(e){const{value:t,className:a,id:l}=e,r=(0,n.useMemo)((()=>void 0===t?qe.Error:t>0&&t<=1e3?qe.Success:t>1e3?qe.Warn:qe.Error),[t]),s=(0,u.jb)(),{loading:o}=(0,c.v9)((e=>i.Es.selectById(e,l)||{id:l,loading:!1}));return void 0!==t||o?o?n.createElement(n.Fragment,null):n.createElement("span",{className:Pe()(a,Ve[r]),onClick:()=>{s(l)}},r===qe.Error?"timeout":`${t}ms`):n.createElement(n.Fragment,null)}!function(e){e.Success="success",e.Warn="warn",e.Error="error"}(qe||(qe={}));const Be={wrapper:"_TBifi4dkudWb4MUgm4j"};function He(){const e=(0,c.v9)(i.hl.selectAll),t=(0,c.v9)((e=>e.selected.proxy)),a=(0,c.I0)();(0,n.useEffect)((()=>{(0,r.yi)().then((e=>{a(i.LF.actions.received(e)),a(s.m.actions.setProxy({id:e.selectedId}))}))}),[a]);const o=[(0,$e.p)({columnId:"name",renderHeaderCell:()=>"Name",renderCell:e=>n.createElement(Re.K,{truncate:!0},e.name)}),(0,$e.p)({columnId:"server",renderHeaderCell:()=>"Server",renderCell:e=>n.createElement(Re.K,{truncate:!0},`${e.server}:${e.port}`)}),(0,$e.p)({columnId:"type",renderHeaderCell:()=>"Type",renderCell:e=>n.createElement(Re.K,{truncate:!0},e.type)}),(0,$e.p)({columnId:"delay",renderHeaderCell:()=>"Delay",renderCell:e=>n.createElement(Re.K,{truncate:!0},n.createElement(Ue,{id:e.id,value:e.delay}))}),(0,$e.p)({columnId:"action",renderHeaderCell:()=>"Action",renderCell:e=>n.createElement(Re.K,{truncate:!0},n.createElement(xe,{proxy:e}))})],d=n.useMemo((()=>new Set([t])),[t]),m=(0,c.v9)((e=>e.setting)).outbound.autoMode.enabled;return n.createElement("div",{className:Be.wrapper},n.createElement(l.iA,{columns:o,data:e,selectionMode:"single",onSelectionChange:async(e,t)=>{if(!m){const e=t.selectedItems.values().next().value;await(0,r.Hl)({id:e}),a(s.m.actions.setProxy({id:e}))}},selectedItems:d}))}function Ze(){return n.createElement("div",{className:ve.wrapper},n.createElement("div",{className:ve.header},n.createElement(Ne,null)),n.createElement("div",{className:ve.content},n.createElement(He,null)))}}}]);