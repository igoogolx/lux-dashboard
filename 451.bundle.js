"use strict";(self.webpackChunklux_dashboard=self.webpackChunklux_dashboard||[]).push([[451],{5451:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var n=a(7294),o=a(6667),r=a(5638),s=a(7255),c=a(2327),l=a(8142),i=a(1275);var u;!function(e){e[e.Destination=0]="Destination",e[e.Process=1]="Process",e[e.Domain=2]="Domain"}(u||(u={}));const d=e=>{const t=(0,i.Xf)();let a="\\";"win32"===t?a="\\":"darwin"===t&&(a="/");const n=e.split(a);return n[n.length-1]};function m(e){const{getValue:t}=e,a=t(),{value:o,unit:s}=(0,r.E6)(a);return n.createElement(n.Fragment,null,`${o} ${s}`)}function h(e){const{getValue:t}=e,a=t(),o=(new Date).getTime()-a;return n.createElement(n.Fragment,null,function(e){const t=e/1e3,a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60),o=Math.floor(t-3600*a-60*n);let r=o.toString(),s=n.toString(),c=a.toString();return a<10&&(c=`0${a}`),n<10&&(s=`0${n}`),o<10&&(r=`0${o}`),`${c}:${s}:${r}`}(o))}function E(e){const{getValue:t}=e,a=t(),{t:r}=(0,c.$)();return a===o.o3.Proxy?n.createElement(s.Vp,{type:s.hu.Info,value:r(l.$.PROXY)}):n.createElement(s.Vp,{type:s.hu.Warning,value:r(l.$.DIRECT)})}function p(){const{t:e}=(0,c.$)(),[t,a]=(0,n.useState)([]),[r,i]=(0,n.useState)({tcp:0,udp:0,history:[]}),[p,$]=(0,n.useState)(""),[S,f]=(0,n.useState)(u.Process);(0,n.useEffect)((()=>{const e=(0,o.Fu)({onMessage:e=>{a(e),i((t=>({tcp:e.filter((e=>e.metadata.network===o.Jj.Tcp)).length,udp:e.filter((e=>e.metadata.network===o.Jj.Udp)).length,history:[...t.history,e.length]})))}});return()=>{e.close()}}),[]);const w=(0,n.useMemo)((()=>[{header:e(l.$.DESTINATION)||"",accessorKey:"destination",minSize:100},{header:e(l.$.PROCESS)||"",accessorKey:"process",minSize:100},{header:e(l.$.Domain)||"",accessorKey:"domain",minSize:100},{header:e(l.$.RULE)||"",accessorKey:"rule",cell:E,minSize:100},{header:e(l.$.NETWORK)||"",accessorKey:"network",minSize:100},{header:e(l.$.TIME)||"",accessorKey:"start",cell:h,minSize:100},{header:e(l.$.DOWNLOAD)||"",accessorKey:"download",cell:m,minSize:100},{header:e(l.$.UPLOAD)||"",accessorKey:"upload",cell:m,minSize:100}]),[e]),D=(0,n.useMemo)((()=>t.map((e=>({process:d(e.process),destination:`${e.metadata.destinationIP}:${e.metadata.destinationPort}`,domain:e.domain,download:e.download,upload:e.upload,network:e.metadata.network,rule:e.rule,start:e.start,id:e.id}))).filter((e=>{if(p)switch(S){case u.Domain:return e.domain.toLocaleLowerCase().includes(p.toLocaleLowerCase());case u.Process:return e.process.toLocaleLowerCase().includes(p.toLocaleLowerCase());case u.Destination:return e.destination.toLocaleLowerCase().includes(p.toLocaleLowerCase());default:throw new Error(`invalid ${p}`)}return!0}))),[t,S,p]),L=[{id:u.Destination,content:e(l.$.DESTINATION)},{id:u.Process,content:e(l.$.PROCESS)},{id:u.Domain,content:e(l.$.Domain)}];return n.createElement("div",{className:"GsNfsjFLpudvPlqiSD2T"},n.createElement("div",{className:"qnlbR8tyn7foo1Csxoh3"},n.createElement(s.BZ,{selectorItems:L,selectorValue:S,inputValue:p,onSelectorChange:f,onInputChange:e=>{$(e.target.value)}}),n.createElement("div",{className:"P6selSKvEjKrUBZGMX8H"},n.createElement(s.zx,{onClick:o.PI,buttonType:s.Bq.Blank,className:"aFuzlT9o5kKPX_keucEr"},n.createElement(s.u,{content:e(l.$.CLOSE_ALL),placement:s.Um.Bottom},n.createElement(s.JO,{name:s.dT.Trash,size:s.ZK.Medium}))))),n.createElement(s.iA,{columns:w,data:D}),n.createElement("div",{className:"uYUjaIcxUFAms48AlACf"},n.createElement("div",null,`TCP:  ${r.tcp}`),n.createElement("div",null,`UDP:  ${r.udp}`)))}},5638:(e,t,a)=>{a.d(t,{E6:()=>r});const n=1048576,o=1024*n,r=e=>e<n?(e=>({value:(e/1024).toFixed(0),unit:"K"}))(e):e<o?(e=>({value:(e/n).toFixed(1),unit:"M"}))(e):(e=>({value:(e/o).toFixed(1),unit:"G"}))(e)}}]);