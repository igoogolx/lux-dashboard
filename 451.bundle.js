"use strict";(self.webpackChunklux_dashboard=self.webpackChunklux_dashboard||[]).push([[451],{5451:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var l=n(7294),a=n(6575),r=n(5638),o=n(5060),c=n(2327),s=n(8142),u=n(5201),d=n(4656),i=n(1588),m=n(8861),p=n(2132),E=n(8870),C=n(6475);const f={wrapper:"GsNfsjFLpudvPlqiSD2T",toolbar:"qnlbR8tyn7foo1Csxoh3",input:"aKGCZGzKFxBcvElaeRcW",actions:"P6selSKvEjKrUBZGMX8H",closeAll:"aFuzlT9o5kKPX_keucEr",footer:"uYUjaIcxUFAms48AlACf"},h=(e,t)=>{let n="\\";"win32"===t?n="\\":"darwin"===t&&(n="/");const l=e.split(n);return l[l.length-1]};function v(e){const{value:t}=e,{value:n,unit:a}=(0,r.E6)(t);return l.createElement(l.Fragment,null,`${n} ${a}`)}function $(e){const{value:t}=e,n=(new Date).getTime()-t;return l.createElement(l.Fragment,null,function(e){const t=e/1e3,n=Math.floor(t/3600),l=Math.floor((t-3600*n)/60),a=Math.floor(t-3600*n-60*l);let r=a.toString(),o=l.toString(),c=n.toString();return n<10&&(c=`0${n}`),l<10&&(o=`0${l}`),a<10&&(r=`0${a}`),`${c}:${o}:${r}`}(n))}function w(){const{t:e}=(0,c.$)(),[t,n]=(0,l.useState)([]),[r,w]=(0,l.useState)({tcp:0,udp:0,history:[]}),[I,g]=(0,l.useState)(""),[K,k]=(0,l.useState)("win32");(0,l.useEffect)((()=>{(0,a.Z$)().then((e=>{k(e.os)}))}),[]),(0,l.useEffect)((()=>{const e=(0,a.Fu)({onMessage:e=>{n(e),w((t=>({tcp:e.filter((e=>e.metadata.network===a.Jj.Tcp)).length,udp:e.filter((e=>e.metadata.network===a.Jj.Udp)).length,history:[...t.history,e.length]})))}});return()=>{e.close()}}),[]);const A=(0,l.useMemo)((()=>[(0,u.p)({columnId:"destination",renderHeaderCell:()=>"Destination",renderCell:e=>l.createElement(d.K,{truncate:!0},e.destination)}),(0,u.p)({columnId:"process",renderHeaderCell:()=>"Process",renderCell:e=>l.createElement(d.K,{truncate:!0},e.process)}),(0,u.p)({columnId:"domain",renderHeaderCell:()=>"Domain",renderCell:e=>l.createElement(d.K,{truncate:!0},e.domain)}),(0,u.p)({columnId:"rule",renderHeaderCell:()=>e(s.$.RULE),renderCell:t=>{let n;return n=t.rule===a.o3.Proxy?l.createElement(o.Vp,{type:o.hu.Info,value:e(s.$.PROXY)}):l.createElement(o.Vp,{type:o.hu.Warning,value:e(s.$.DIRECT)}),l.createElement(d.K,null,n)}}),(0,u.p)({columnId:"network",renderHeaderCell:()=>e(s.$.NETWORK),renderCell:e=>l.createElement(d.K,null,e.network)}),(0,u.p)({columnId:"start",renderHeaderCell:()=>e(s.$.TIME),renderCell:e=>l.createElement(d.K,null,l.createElement($,{value:e.start}))}),(0,u.p)({columnId:"data",renderHeaderCell:()=>e(s.$.DATA),renderCell:e=>l.createElement(d.K,null,l.createElement(v,{value:e.download+e.upload}))})]),[e]),P=(0,l.useMemo)((()=>t.map((e=>({process:h(e.process,K),destination:`${e.metadata.destinationIP}:${e.metadata.destinationPort}`,domain:e.domain,download:e.download,upload:e.upload,network:e.metadata.network,rule:e.rule,start:e.start,id:e.id}))).filter((e=>!I||[e.domain,e.process,e.destination].some((e=>e.toLocaleLowerCase().includes(I.toLocaleLowerCase())))))),[t,K,I]);return l.createElement("div",{className:f.wrapper},l.createElement("div",{className:f.toolbar},l.createElement(i.I,{value:I,onChange:e=>{g(e.target.value)},contentAfter:l.createElement(E.dOe,null),placeholder:e(s.$.SEARCH_CONNECTION_TIP),className:f.input}),l.createElement("div",{className:f.actions},l.createElement(m.u,{content:e(s.$.CLOSE_ALL),relationship:"description"},l.createElement(p.z,{onClick:a.PI,className:f.closeAll,icon:l.createElement(C.X10,null)},"Close All")))),l.createElement(o.iA,{columns:A,data:P}),l.createElement("div",{className:f.footer},l.createElement("div",null,`TCP:  ${r.tcp}`),l.createElement("div",null,`UDP:  ${r.udp}`)))}},5638:(e,t,n)=>{n.d(t,{E6:()=>r});const l=1048576,a=1024*l,r=e=>e<l?(e=>({value:(e/1024).toFixed(0),unit:"K"}))(e):e<a?(e=>({value:(e/l).toFixed(1),unit:"M"}))(e):(e=>({value:(e/a).toFixed(1),unit:"G"}))(e)}}]);