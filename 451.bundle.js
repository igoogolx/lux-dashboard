"use strict";(self.webpackChunklux_dashboard=self.webpackChunklux_dashboard||[]).push([[451],{5451:(e,t,l)=>{l.r(t),l.d(t,{default:()=>w});var n=l(7294),a=l(6575),r=l(5638),o=l(634),c=l(2327),d=l(8142),u=l(5201),s=l(4656),i=l(1588),m=l(8861),p=l(2132),E=l(8870),C=l(6475);const f={wrapper:"GsNfsjFLpudvPlqiSD2T",toolbar:"qnlbR8tyn7foo1Csxoh3",input:"aKGCZGzKFxBcvElaeRcW",actions:"P6selSKvEjKrUBZGMX8H",closeAll:"aFuzlT9o5kKPX_keucEr",footer:"uYUjaIcxUFAms48AlACf"},v=(e,t)=>{let l="\\";"win32"===t?l="\\":"darwin"===t&&(l="/");const n=e.split(l);return n[n.length-1]};function $(e){const{value:t}=e,{value:l,unit:a}=(0,r.E6)(t);return n.createElement(n.Fragment,null,`${l} ${a}`)}function h(e){const{value:t}=e,l=(new Date).getTime()-t;return n.createElement(n.Fragment,null,function(e){const t=e/1e3,l=Math.floor(t/3600),n=Math.floor((t-3600*l)/60),a=Math.floor(t-3600*l-60*n);let r=a.toString(),o=n.toString(),c=l.toString();return l<10&&(c=`0${l}`),n<10&&(o=`0${n}`),a<10&&(r=`0${a}`),`${c}:${o}:${r}`}(l))}function w(){const{t:e}=(0,c.$)(),[t,l]=(0,n.useState)([]),[r,w]=(0,n.useState)({tcp:0,udp:0,history:[]}),[I,K]=(0,n.useState)(""),[g,k]=(0,n.useState)("win32");(0,n.useEffect)((()=>{(0,a.Z$)().then((e=>{k(e.os)}))}),[]),(0,n.useEffect)((()=>{const e=(0,a.Fu)({onMessage:e=>{l(e),w((t=>({tcp:e.filter((e=>e.metadata.network===a.Jj.Tcp)).length,udp:e.filter((e=>e.metadata.network===a.Jj.Udp)).length,history:[...t.history,e.length]})))}});return()=>{e.close()}}),[]);const P=(0,n.useMemo)((()=>[(0,u.p)({columnId:"destination",renderHeaderCell:()=>"Destination",renderCell:e=>n.createElement(s.K,{truncate:!0},e.destination)}),(0,u.p)({columnId:"process",renderHeaderCell:()=>"Process",renderCell:e=>n.createElement(s.K,{truncate:!0},e.process)}),(0,u.p)({columnId:"domain",renderHeaderCell:()=>"Domain",renderCell:e=>n.createElement(s.K,{truncate:!0},e.domain)}),(0,u.p)({columnId:"rule",renderHeaderCell:()=>e(d.$.RULE),renderCell:t=>{let l;return l=t.rule===a.o3.Proxy?n.createElement(o.Vp,{type:o.hu.Info,value:e(d.$.PROXY)}):n.createElement(o.Vp,{type:o.hu.Warning,value:e(d.$.DIRECT)}),n.createElement(s.K,null,l)}}),(0,u.p)({columnId:"network",renderHeaderCell:()=>e(d.$.NETWORK),renderCell:e=>n.createElement(s.K,null,e.network)}),(0,u.p)({columnId:"start",renderHeaderCell:()=>e(d.$.TIME),renderCell:e=>n.createElement(s.K,null,n.createElement(h,{value:e.start}))}),(0,u.p)({columnId:"download",renderHeaderCell:()=>e(d.$.DOWNLOAD),renderCell:e=>n.createElement(s.K,null,n.createElement($,{value:e.download}))}),(0,u.p)({columnId:"upload",renderHeaderCell:()=>e(d.$.UPLOAD),renderCell:e=>n.createElement(s.K,null,n.createElement($,{value:e.upload}))})]),[e]),A=(0,n.useMemo)((()=>t.map((e=>({process:v(e.process,g),destination:`${e.metadata.destinationIP}:${e.metadata.destinationPort}`,domain:e.domain,download:e.download,upload:e.upload,network:e.metadata.network,rule:e.rule,start:e.start,id:e.id}))).filter((e=>!I||[e.domain,e.process,e.destination].some((e=>e.toLocaleLowerCase().includes(I.toLocaleLowerCase())))))),[t,g,I]);return n.createElement("div",{className:f.wrapper},n.createElement("div",{className:f.toolbar},n.createElement(i.I,{value:I,onChange:e=>{K(e.target.value)},contentAfter:n.createElement(E.dOe,null),placeholder:e(d.$.SEARCH_CONNECTION_TIP),className:f.input}),n.createElement("div",{className:f.actions},n.createElement(m.u,{content:e(d.$.CLOSE_ALL),relationship:"description"},n.createElement(p.z,{onClick:a.PI,className:f.closeAll,icon:n.createElement(C.X10,null)},"Close All")))),n.createElement(o.iA,{columns:P,data:A}),n.createElement("div",{className:f.footer},n.createElement("div",null,`TCP:  ${r.tcp}`),n.createElement("div",null,`UDP:  ${r.udp}`)))}},5638:(e,t,l)=>{l.d(t,{E6:()=>r});const n=1048576,a=1024*n,r=e=>e<n?(e=>({value:(e/1024).toFixed(0),unit:"K"}))(e):e<a?(e=>({value:(e/n).toFixed(1),unit:"M"}))(e):(e=>({value:(e/a).toFixed(1),unit:"G"}))(e)}}]);