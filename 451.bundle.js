"use strict";(self.webpackChunklux_dashboard=self.webpackChunklux_dashboard||[]).push([[451],{5451:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var n=a(7294),o=a(6667),l=a(5638),r=a(6974),s=a(2327),c=a(8142),i=a(1275);const u=e=>{const t=(0,i.Xf)();let a="\\";"win32"===t?a="\\":"darwin"===t&&(a="/");const n=e.split(a);return n[n.length-1]};function d(e){const{getValue:t}=e,a=t(),{value:o,unit:r}=(0,l.E6)(a);return n.createElement(n.Fragment,null,`${o} ${r}`)}function m(e){const{getValue:t}=e,a=t(),o=(new Date).getTime()-a;return n.createElement(n.Fragment,null,function(e){const t=e/1e3,a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60),o=Math.floor(t-3600*a-60*n);let l=o.toString(),r=n.toString(),s=a.toString();return a<10&&(s=`0${a}`),n<10&&(r=`0${n}`),o<10&&(l=`0${o}`),`${s}:${r}:${l}`}(o))}function E(e){const{getValue:t}=e,a=t(),{t:l}=(0,s.$)();return a===o.o3.Proxy?n.createElement(r.Vp,{type:r.hu.Info,value:l(c.$.PROXY)}):n.createElement(r.Vp,{type:r.hu.Warning,value:l(c.$.DIRECT)})}function h(){const{t:e}=(0,s.$)(),[t,a]=(0,n.useState)([]),[l,i]=(0,n.useState)({tcp:0,udp:0,history:[]}),[h,p]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=(0,o.Fu)({onMessage:e=>{a(e),i((t=>({tcp:e.filter((e=>e.metadata.network===o.Jj.Tcp)).length,udp:e.filter((e=>e.metadata.network===o.Jj.Udp)).length,history:[...t.history,e.length]})))}});return()=>{e.close()}}),[]);const $=(0,n.useMemo)((()=>[{header:e(c.$.DESTINATION)||"",accessorKey:"destination",minSize:100},{header:e(c.$.PROCESS)||"",accessorKey:"process",minSize:100},{header:e(c.$.Domain)||"",accessorKey:"domain",minSize:100},{header:e(c.$.RULE)||"",accessorKey:"rule",cell:E,minSize:100},{header:e(c.$.NETWORK)||"",accessorKey:"network",minSize:100},{header:e(c.$.TIME)||"",accessorKey:"start",cell:m,minSize:100},{header:e(c.$.DOWNLOAD)||"",accessorKey:"download",cell:d,minSize:100},{header:e(c.$.UPLOAD)||"",accessorKey:"upload",cell:d,minSize:100}]),[e]),S=(0,n.useMemo)((()=>t.map((e=>({process:u(e.process),destination:`${e.metadata.destinationIP}:${e.metadata.destinationPort}`,domain:e.domain,download:e.download,upload:e.upload,network:e.metadata.network,rule:e.rule,start:e.start,id:e.id}))).filter((e=>!h||[e.domain,e.process,e.destination].some((e=>e.toLocaleLowerCase().includes(h.toLocaleLowerCase())))))),[t,h]);return n.createElement("div",{className:"GsNfsjFLpudvPlqiSD2T"},n.createElement("div",{className:"qnlbR8tyn7foo1Csxoh3"},n.createElement(r.II,{value:h,onChange:e=>{p(e.target.value)},adornment:n.createElement(r.JO,{name:r.dT.Search,className:"KVpTMwbTH1UsyGD4Q22N"}),placeholder:e(c.$.SEARCH_CONNECTION_TIP),className:"aKGCZGzKFxBcvElaeRcW"}),n.createElement("div",{className:"P6selSKvEjKrUBZGMX8H"},n.createElement(r.zx,{onClick:o.PI,buttonType:r.Bq.Blank,className:"aFuzlT9o5kKPX_keucEr"},n.createElement(r.u,{content:e(c.$.CLOSE_ALL),placement:r.Um.Bottom},n.createElement(r.JO,{name:r.dT.Trash,size:r.ZK.Medium}))))),n.createElement(r.iA,{columns:$,data:S}),n.createElement("div",{className:"uYUjaIcxUFAms48AlACf"},n.createElement("div",null,`TCP:  ${l.tcp}`),n.createElement("div",null,`UDP:  ${l.udp}`)))}},5638:(e,t,a)=>{a.d(t,{E6:()=>l});const n=1048576,o=1024*n,l=e=>e<n?(e=>({value:(e/1024).toFixed(0),unit:"K"}))(e):e<o?(e=>({value:(e/n).toFixed(1),unit:"M"}))(e):(e=>({value:(e/o).toFixed(1),unit:"G"}))(e)}}]);