"use strict";(self.webpackChunklux_dashboard=self.webpackChunklux_dashboard||[]).push([[741],{8741:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var n=a(7294),o=a(3422),r=a(5638),l=a(8726),s=a(2327),c=a(8142);const i=function({value:e}){const{t}=(0,s.$)();return e===o.o3.Proxy?n.createElement(l.Vp,{type:l.hu.Info,value:t(c.$.PROXY)}):n.createElement(l.Vp,{type:l.hu.Warning,value:t(c.$.DIRECT)})},u=function(e){const{close:t}=e,{t:a}=(0,s.$)(),[r,u]=(0,n.useState)(""),[d,m]=(0,n.useState)(null);return n.createElement(l.u_,{close:t},n.createElement("div",{className:"snirEdcmUD2Bw1yAKOd6"},n.createElement(l.II,{value:r,onChange:e=>{u(e.target.value)},className:"lcs8Zrbl1pV3Els9zlhI"}),n.createElement(l.zx,{onClick:()=>{(0,o.ED)({destination:r}).then((e=>{m(e.rule)}))}},a(c.$.SEARCH))),n.createElement("div",{className:"_fyru2fdqoXWQoeyE7ET"},n.createElement("div",{className:"GLeqgCzGh6EqHrjpKif_"},"Result:"),null!==d&&n.createElement(i,{value:d})))};var d=a(1275);var m;!function(e){e[e.Destination=0]="Destination",e[e.Process=1]="Process",e[e.Domain=2]="Domain"}(m||(m={}));const E=e=>{const t=(0,d.Xf)();let a="\\";"win32"===t?a="\\":"darwin"===t&&(a="/");const n=e.split(a);return n[n.length-1]};function p(e){const{getValue:t}=e,a=t(),{value:o,unit:l}=(0,r.E6)(a);return n.createElement(n.Fragment,null,`${o} ${l}`)}function h(e){const{getValue:t}=e,a=t(),o=(new Date).getTime()-a;return n.createElement(n.Fragment,null,function(e){const t=e/1e3,a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60),o=Math.floor(t-3600*a-60*n);let r=o.toString(),l=n.toString(),s=a.toString();return a<10&&(s=`0${a}`),n<10&&(l=`0${n}`),o<10&&(r=`0${o}`),`${s}:${l}:${r}`}(o))}function $(e){const{getValue:t}=e,a=t(),{t:r}=(0,s.$)();return a===o.o3.Proxy?n.createElement(l.Vp,{type:l.hu.Info,value:r(c.$.PROXY)}):n.createElement(l.Vp,{type:l.hu.Warning,value:r(c.$.DIRECT)})}function f(){const{t:e}=(0,s.$)(),[t,a]=(0,n.useState)([]),[r,i]=(0,n.useState)({tcp:0,udp:0,history:[]}),[d,f]=(0,n.useState)(""),[S,v]=(0,n.useState)(m.Process),[y,w]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=(0,o.Fu)({onMessage:e=>{a(e),i((t=>({tcp:e.filter((e=>e.metadata.network===o.Jj.Tcp)).length,udp:e.filter((e=>e.metadata.network===o.Jj.Udp)).length,history:[...t.history,e.length]})))}});return()=>{e.close()}}),[]);const C=(0,n.useMemo)((()=>[{header:e(c.$.DESTINATION)||"",accessorKey:"destination",minSize:100},{header:e(c.$.PROCESS)||"",accessorKey:"process",minSize:100},{header:e(c.$.Domain)||"",accessorKey:"domain",minSize:100},{header:e(c.$.RULE)||"",accessorKey:"rule",cell:$,minSize:100},{header:e(c.$.NETWORK)||"",accessorKey:"network",minSize:100},{header:e(c.$.TIME)||"",accessorKey:"start",cell:h,minSize:100},{header:e(c.$.DOWNLOAD)||"",accessorKey:"download",cell:p,minSize:100},{header:e(c.$.UPLOAD)||"",accessorKey:"upload",cell:p,minSize:100}]),[e]),g=(0,n.useMemo)((()=>t.map((e=>({process:E(e.process),destination:`${e.metadata.destinationIP}:${e.metadata.destinationPort}`,domain:e.domain,download:e.download,upload:e.upload,network:e.metadata.network,rule:e.rule,start:e.start,id:e.id}))).filter((e=>{if(d)switch(S){case m.Domain:return e.domain.toLocaleLowerCase().includes(d.toLocaleLowerCase());case m.Process:return e.process.toLocaleLowerCase().includes(d.toLocaleLowerCase());case m.Destination:return e.destination.toLocaleLowerCase().includes(d.toLocaleLowerCase());default:throw new Error(`invalid ${d}`)}return!0}))),[t,S,d]),D=[{id:m.Destination,content:e(c.$.DESTINATION)},{id:m.Process,content:e(c.$.PROCESS)},{id:m.Domain,content:e(c.$.Domain)}];return n.createElement("div",{className:"GsNfsjFLpudvPlqiSD2T"},y&&n.createElement(u,{close:()=>{w(!1)}}),n.createElement("div",{className:"qnlbR8tyn7foo1Csxoh3"},n.createElement(l.BZ,{selectorItems:D,selectorValue:S,inputValue:d,onSelectorChange:v,onInputChange:e=>{f(e.target.value)}}),n.createElement("div",{className:"P6selSKvEjKrUBZGMX8H"},n.createElement(l.zx,{onClick:()=>{w(!0)},buttonType:l.Bq.Secondary},"Test Rule"),n.createElement(l.zx,{onClick:o.PI,buttonType:l.Bq.Blank,className:"aFuzlT9o5kKPX_keucEr"},n.createElement(l.u,{content:e(c.$.CLOSE_ALL),placement:l.Um.Bottom},n.createElement(l.JO,{name:l.dT.Trash,size:l.ZK.Medium}))))),n.createElement(l.iA,{columns:C,data:g}),n.createElement("div",{className:"uYUjaIcxUFAms48AlACf"},n.createElement("div",null,`Tcp:  ${r.tcp}`),n.createElement("div",null,`Udp:  ${r.udp}`)))}},5638:(e,t,a)=>{a.d(t,{E6:()=>r});const n=1048576,o=1024*n,r=e=>e<n?(e=>({value:(e/1024).toFixed(0),unit:"K"}))(e):e<o?(e=>({value:(e/n).toFixed(1),unit:"M"}))(e):(e=>({value:(e/o).toFixed(1),unit:"G"}))(e)}}]);